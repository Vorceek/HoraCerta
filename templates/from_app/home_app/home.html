<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BarberFinder ‚Ä¢ Home</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    /* ===== Reset b√°sico ===== */
    *,
    *::before,
    *::after { margin:0; padding:0; box-sizing:border-box; }

    :root {
      --bg: #f5f7fb;
      --bg-card: #ffffff;
      --accent: #4f46e5;
      --accent-soft: rgba(79, 70, 229, 0.12);
      --accent-strong: #4338ca;

      --text: #0f172a;
      --text-muted: #475569;

      --border: #e2e8f0;
      --error: #dc2626;
      --success: #16a34a;
      --warn: #b45309;

      --shadow-soft: 0 14px 34px rgba(15, 23, 42, 0.08);
      --radius-lg: 18px;
      --radius-md: 12px;

      --transition-fast: 0.25s ease;
    }

    body {
      font-family: 'Poppins', sans-serif;
      min-height: 100vh;
      background: radial-gradient(circle at top, #ffffff, #eef2f7 60%);
      color: var(--text);
    }
    a { color: inherit; text-decoration: none; }

    /* ===== Layout base ===== */
    .container{
      max-width:1200px;
      margin:0 auto;
      padding: 22px 20px 40px;
    }

    /* ===== HEADER ===== */
    .app-header {
      position: sticky; top:0; z-index:20;
      background: rgba(255,255,255,0.9);
      border-bottom: 1px solid var(--border);
      backdrop-filter: blur(10px);
    }
    .app-header-inner {
      max-width: 1200px; margin:0 auto; padding: 14px 20px;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
    }
    .app-logo {
      display:inline-flex; align-items:center; gap:10px;
      font-weight:700; letter-spacing:.3px;
    }
    .logo-mark {
      width:36px; height:36px; border-radius:999px; display:grid; place-items:center;
      background: radial-gradient(circle at top, var(--accent-strong), #312e81);
      color:#fff; font-weight:700;
      box-shadow:0 10px 22px rgba(67,56,202,.35);
    }
    .header-actions { display:flex; align-items:center; gap:8px; }
    .btn-header{
      display:inline-flex; align-items:center; gap:8px;
      padding:9px 14px; border-radius:999px; font-size:.9rem; font-weight:600;
      border:1px solid var(--border); background:#fff; box-shadow:var(--shadow-soft);
      cursor:pointer; transition:transform .12s ease-out, background var(--transition-fast);
      white-space: nowrap;
    }
    .btn-header:hover{ transform:translateY(-1px); background:#f8fafc; }

    /* ===== HERO ===== */
    .hero {
      position: relative;
      min-height: 44vh;
      display:grid; place-items:center;
      text-align:center;
      padding: 48px 20px 30px;
      background:
        radial-gradient(1000px circle at 10% -10%, rgba(79,70,229,0.22), transparent 55%),
        radial-gradient(900px circle at 90% 0%, rgba(6,182,212,0.16), transparent 60%),
        linear-gradient(180deg, #ffffff 0%, #eef2f7 100%);
    }

    .hero-card {
      width:min(980px,100%);
      padding:24px 22px;
      border-radius:clamp(16px,2vw,22px);
      background:
        linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.98)),
        url('https://images.unsplash.com/photo-1516979187457-637abb4f9353?q=80&w=1400&auto=format&fit=crop')
          center/cover no-repeat;
      border:1px solid var(--border);
      box-shadow:var(--shadow-soft);
      position:relative; overflow:hidden; isolation:isolate;
    }
    .hero-card::after{
      content:""; position:absolute; inset:0;
      background: linear-gradient(
        180deg,
        rgba(15,23,42,0.55),
        rgba(15,23,42,0.18) 55%,
        rgba(255,255,255,0.85) 100%
      );
      z-index:-1;
    }
    .hero-content{ color:#0b1020; display:grid; gap:10px; padding:8px; }
    .hero-badge{
      margin:0 auto; display:inline-flex; align-items:center; gap:8px;
      padding:6px 12px; font-size:.78rem; font-weight:600;
      color:var(--accent-strong); background:rgba(255,255,255,0.9);
      border:1px solid var(--border); border-radius:999px; box-shadow:var(--shadow-soft);
    }
    .hero h1{
      font-size:clamp(1.7rem,3vw,2.6rem);
      font-weight:700; color:#0f172a;
      text-shadow:0 6px 18px rgba(15,23,42,0.12);
    }
    .hero p{
      font-size:clamp(1rem,1.4vw,1.1rem);
      color:#0f172a; opacity:.9;
    }
    .hero-actions{
      margin-top:6px;
      display:flex; gap:10px; justify-content:center; flex-wrap:wrap;
    }
    .btn-primary, .btn-secondary{
      display:inline-flex; align-items:center; justify-content:center;
      padding:10px 16px; border-radius:999px;
      font-size:.95rem; font-weight:600; cursor:pointer;
      transition: transform .12s ease-out, box-shadow var(--transition-fast), background var(--transition-fast);
      border:1px solid transparent; white-space: nowrap;
    }
    .btn-primary{
      background: linear-gradient(135deg, var(--accent), var(--accent-strong));
      color:#fff; box-shadow:0 12px 28px rgba(79,70,229,0.30);
    }
    .btn-primary:hover{ transform:translateY(-1px); box-shadow:0 18px 40px rgba(79,70,229,0.35); }
    .btn-secondary{
      background:#fff; border-color:var(--border);
      color:var(--text); box-shadow:var(--shadow-soft);
    }
    .btn-secondary:hover{ background:#f8fafc; transform:translateY(-1px); }

    /* ===== DASHBOARD (cliente) ===== */
    .dash-grid{
      display:grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1fr);
      gap:18px;
      margin-top: 6px;
    }

    .dash-card{
      background:var(--bg-card);
      border:1px solid var(--border);
      border-radius:var(--radius-lg);
      box-shadow:var(--shadow-soft);
      padding:16px;
      display:grid;
      gap:10px;
    }

    .dash-title{
      font-size:1.05rem;
      font-weight:700;
      display:flex; align-items:center; justify-content:space-between;
      gap:8px;
    }
    .dash-sub{
      font-size:.9rem;
      color:var(--text-muted);
    }

    .status-pill{
      display:inline-flex; align-items:center; gap:6px;
      padding:4px 8px; border-radius:999px; font-size:.78rem; font-weight:700;
      border:1px solid var(--border); background:#f8fafc; color:var(--text);
      white-space: nowrap;
    }
    .status-pill.success{ background:#dcfce7; border-color:#bbf7d0; color:var(--success); }
    .status-pill.warn{ background:#fef3c7; border-color:#fde68a; color:var(--warn); }

    .next-box{
      display:grid; gap:8px;
      padding:12px;
      border-radius:14px;
      border:1px dashed var(--border);
      background:#fbfdff;
    }
    .next-line{
      display:flex; align-items:center; justify-content:space-between; gap:8px;
      font-size:.95rem;
    }
    .next-label{ color:var(--text-muted); font-size:.85rem; }

    .mini-list{
      display:grid; gap:8px;
    }
    .mini-item{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--border);
      background:#fff;
      transition: background var(--transition-fast), transform .12s ease-out;
    }
    .mini-item:hover{ background:#f8fafc; transform:translateY(-1px); }
    .mini-main{ display:grid; gap:2px; }
    .mini-title{ font-weight:700; font-size:.95rem; }
    .mini-meta{ color:var(--text-muted); font-size:.85rem; }

    /* ===== Se√ß√£o Barbearias ===== */
    .section-head{
      display:flex; align-items:end; justify-content:space-between;
      gap:14px; flex-wrap:wrap; margin-top: 26px; margin-bottom:14px;
    }
    h2{ font-size:clamp(1.4rem,2vw,1.9rem); font-weight:700; }
    .subtitle{ font-size:.95rem; color:var(--text-muted); }

    /* filtros */
    .filters{
      width:min(640px,100%);
      display:grid; grid-template-columns:1fr auto auto; gap:8px;
      background:#fff; border:1px solid var(--border);
      border-radius:999px; padding:6px; box-shadow:var(--shadow-soft);
    }
    .filters input{
      border:none; outline:none; padding:8px 12px; font-size:.95rem;
      border-radius:999px; background:transparent; color:var(--text);
    }
    .filters select{
      border:1px solid var(--border); background:#fff; padding:8px 10px;
      border-radius:999px; font-size:.9rem; color:var(--text); outline:none; cursor:pointer;
    }
    .filters button{
      border:none; background:var(--accent); color:#fff; font-weight:600;
      padding:9px 14px; border-radius:999px; cursor:pointer;
      transition:background var(--transition-fast), transform .12s ease-out;
    }
    .filters button:hover{ background:var(--accent-strong); transform:translateY(-1px); }

    .grid{
      margin-top:16px;
      display:grid; grid-template-columns:repeat(auto-fill, minmax(280px,1fr));
      gap:18px;
    }

    .card{
      background:var(--bg-card);
      border-radius:var(--radius-lg);
      overflow:hidden;
      border:1px solid var(--border);
      box-shadow:var(--shadow-soft);
      transition:transform .16s ease-out, box-shadow var(--transition-fast), border-color var(--transition-fast);
      display:grid; grid-template-rows:auto 1fr;
    }
    .card:hover{
      transform:translateY(-4px);
      border-color:rgba(79,70,229,0.45);
      box-shadow:0 18px 40px rgba(15,23,42,0.12);
    }
    .card-media{ position:relative; height:190px; background:#e2e8f0; }
    .card-media img{ width:100%; height:100%; object-fit:cover; display:block; }
    .badge-top{
      position:absolute; top:12px; left:12px;
      padding:6px 10px; font-size:.78rem; font-weight:700;
      background:rgba(255,255,255,0.95); border:1px solid var(--border);
      border-radius:999px; box-shadow:var(--shadow-soft);
    }
    .card-body{ padding:14px 14px 16px; display:grid; gap:8px; }
    .card-title{ display:flex; align-items:center; justify-content:space-between; gap:8px; }
    .card-body h3{ font-size:1.15rem; font-weight:700; }
    .rating{
      display:inline-flex; align-items:center; gap:6px;
      font-size:.9rem; font-weight:700; color:#b45309;
      background:#fef3c7; padding:4px 8px;
      border-radius:999px; border:1px solid #fde68a;
      white-space: nowrap;
    }
    .address{ font-size:.95rem; color:var(--text-muted); line-height:1.35; min-height:2.6em; }
    .card-actions{ margin-top:4px; display:flex; gap:8px; flex-wrap:wrap; }
    .btn-details{
      padding:9px 12px; border-radius:10px; font-size:.9rem; font-weight:600;
      border:1px solid var(--border); background:#fff;
      transition:background var(--transition-fast), transform .12s ease-out;
      white-space: nowrap;
    }
    .btn-details:hover{ background:#f8fafc; transform:translateY(-1px); }

    .empty{
      margin-top:14px; padding:18px; border-radius:14px;
      background:#fff; border:1px dashed var(--border);
      color:var(--text-muted);
    }

    /* ===== PAGINA√á√ÉO ===== */
    .pagination{
      margin-top:22px;
      display:flex; align-items:center; justify-content:center;
      gap:10px; flex-wrap:wrap;
    }
    .page-btn{
      padding:8px 12px; border-radius:999px; border:1px solid var(--border);
      background:#fff; font-size:.9rem; font-weight:600; box-shadow:var(--shadow-soft);
      transition:transform .12s ease-out, background var(--transition-fast);
      white-space: nowrap;
    }
    .page-btn:hover{ background:#f8fafc; transform:translateY(-1px); }
    .page-btn.disabled{ opacity:.5; cursor:not-allowed; box-shadow:none; }

    .page-numbers{
      display:inline-flex; align-items:center; gap:6px; padding:6px;
      background:#fff; border:1px solid var(--border);
      border-radius:999px; box-shadow:var(--shadow-soft);
    }
    .page-num{
      min-width:34px; height:34px; display:grid; place-items:center;
      border-radius:999px; font-weight:700; font-size:.9rem;
      color:var(--text); border:1px solid transparent;
      transition:background var(--transition-fast), color var(--transition-fast);
    }
    .page-num:hover{ background:#eef2ff; color:var(--accent-strong); }
    .page-num.active{
      background:linear-gradient(135deg, var(--accent), var(--accent-strong));
      color:#fff; box-shadow:0 8px 16px rgba(79,70,229,.25);
    }
    .page-ellipsis{ padding:0 6px; color:var(--text-muted); font-weight:700; }

    /* ===== Skeleton ===== */
    .hidden{ display:none !important; }
    .skeleton-block, .skeleton-line, .skeleton-pill{
      background: linear-gradient(90deg, #eef2f7 0%, #f8fafc 45%, #eef2f7 100%);
      background-size:200% 100%;
      animation: shimmer 1.2s infinite linear;
      border-radius:10px;
    }
    .skeleton-block{ height:190px; }
    .skeleton-line{ height:12px; margin-top:10px; }
    .skeleton-pill{ height:34px; border-radius:999px; }
    .skeleton-actions{ margin-top:12px; display:flex; gap:8px; }
    .w-90{ width:90%; } .w-70{ width:70%; } .w-40{ width:40%; } .w-30{ width:30%; }

    @keyframes shimmer{
      0%{ background-position:200% 0; }
      100%{ background-position:-200% 0; }
    }

    /* ===== FOOTER ===== */
    footer{
      margin-top: 26px;
      border-top:1px solid var(--border);
      background: rgba(255,255,255,0.95);
    }
    .footer-inner{
      max-width:1200px; margin:0 auto; padding:18px 20px;
      display:flex; align-items:center; justify-content:space-between;
      gap:10px; color:var(--text-muted); font-size:.9rem; flex-wrap:wrap;
    }

    /* ===== Responsivo ===== */
    @media (max-width: 1024px){
      .dash-grid{ grid-template-columns: 1fr; }
    }
    @media (max-width:768px){
      .filters{ grid-template-columns:1fr; border-radius:16px; }
      .filters select, .filters button, .filters input{ border-radius:12px; }
      .hero{ min-height:36vh; }
      .hero-card{ padding:20px 16px; }
    }
  </style>
</head>

<body>

  <!-- HEADER -->
  <header class="app-header">
    <div class="app-header-inner">
      <div class="app-logo">
        <span class="logo-mark">B</span>
        <span>BarberFinder</span>
      </div>

      <div class="header-actions">
        <a class="btn-header" href="{% url 'home_cliente' %}">In√≠cio</a>
        <a class="btn-header" href="{% url 'agendar_horario' %}">Agendar</a>
        <a class="btn-header" href="{% url 'meus_horarios' %}">Meus hor√°rios</a>
        <a class="btn-header" href="{% url 'lista_barbeiros' %}">Barbeiros</a>
        <a class="btn-header" href="{% url 'lista_servicos' %}">Servi√ßos</a>
      </div>
    </div>
  </header>

  <!-- HERO -->
  <section class="hero">
    <div class="hero-card">
      <div class="hero-content">
        <div class="hero-badge">‚úÇÔ∏è Bem-vindo, {{ request.user.first_name|default:request.user.username }}!</div>
        <h1>Seu painel BarberFinder</h1>
        <p>Agende, acompanhe seus hor√°rios e encontre as melhores barbearias.</p>

        <div class="hero-actions">
          <a class="btn-primary" href="{% url 'agendar_horario' %}">Agendar agora</a>
          <a class="btn-secondary" href="#barbearias">Explorar barbearias</a>
        </div>
      </div>
    </div>
  </section>

  <!-- DASHBOARD -->
  <main class="container">
    <div class="dash-grid">

      <!-- Pr√≥ximo hor√°rio -->
      <section class="dash-card">
        <div class="dash-title">
          <span>Pr√≥ximo hor√°rio</span>
          {% if proximo_horario %}
            <span class="status-pill warn">‚è≥ {{ proximo_horario.status }}</span>
          {% else %}
            <span class="status-pill">Sem agendamentos</span>
          {% endif %}
        </div>

        {% if proximo_horario %}
          <div class="next-box">
            <div class="next-line">
              <div>
                <div class="next-label">Data</div>
                <strong>{{ proximo_horario.data|date:"d/m/Y" }}</strong>
              </div>
              <div>
                <div class="next-label">Hora</div>
                <strong>{{ proximo_horario.hora|time:"H:i" }}</strong>
              </div>
            </div>

            <div class="next-line">
              <div>
                <div class="next-label">Barbeiro</div>
                <strong>{{ proximo_horario.barbeiro.nome }}</strong>
              </div>
              <div>
                <div class="next-label">Servi√ßo</div>
                <strong>{{ proximo_horario.servico.nome }}</strong>
              </div>
            </div>

            <div class="next-line">
              <a class="btn-primary" href="{% url 'meus_horarios' %}">Gerenciar agendamento</a>
              <a class="btn-secondary" href="{% url 'remarcar_horario' proximo_horario.id %}">Remarcar</a>
            </div>
          </div>
        {% else %}
          <div class="dash-sub">Voc√™ n√£o tem hor√°rios futuros. Que tal agendar?</div>
          <a class="btn-primary" href="{% url 'agendar_horario' %}">Agendar</a>
        {% endif %}
      </section>

      <!-- √öltimos atendimentos -->
      <section class="dash-card">
        <div class="dash-title">
          <span>√öltimos atendimentos</span>
          <a class="dash-sub" href="{% url 'meus_horarios' %}">Ver todos ‚Üí</a>
        </div>

        {% if ultimos_atendimentos %}
          <div class="mini-list">
            {% for a in ultimos_atendimentos %}
              <a class="mini-item" href="{% url 'detalhe_atendimento' a.id %}">
                <div class="mini-main">
                  <div class="mini-title">{{ a.servico.nome }} ‚Ä¢ {{ a.barbeiro.nome }}</div>
                  <div class="mini-meta">{{ a.data|date:"d/m/Y" }} √†s {{ a.hora|time:"H:i" }}</div>
                </div>
                <span class="status-pill success">{{ a.status }}</span>
              </a>
            {% endfor %}
          </div>
        {% else %}
          <div class="dash-sub">Nenhum atendimento conclu√≠do ainda.</div>
        {% endif %}
      </section>
    </div>

    <!-- ===== BARBEARIAS ===== -->
    <section id="barbearias">
      <div class="section-head">
        <div>
          <h2>Barbearias registradas ({{ page_obj.paginator.count }})</h2>
          <div class="subtitle">Busque por nome/endere√ßo e ordene como preferir.</div>
        </div>

        <form class="filters" method="get">
          <input type="text" name="q" value="{{ q }}" placeholder="Buscar por nome, bairro ou cidade..." />
          <select name="ordem">
            <option value="">Ordenar</option>
            <option value="nota" {% if ordem == "nota" %}selected{% endif %}>Melhor nota</option>
            <option value="recentes" {% if ordem == "recentes" %}selected{% endif %}>Mais recentes</option>
          </select>
          <button type="submit">Buscar</button>
        </form>
      </div>

      <!-- Skeletons -->
      <div id="skeleton-grid" class="grid skeleton-grid hidden" aria-hidden="true">
        {% for _ in "12345678" %}
        <article class="card">
          <div class="card-media skeleton-block"></div>
          <div class="card-body">
            <div class="skeleton-line w-70"></div>
            <div class="skeleton-line w-40"></div>
            <div class="skeleton-line w-90"></div>
            <div class="skeleton-actions">
              <div class="skeleton-pill w-40"></div>
              <div class="skeleton-pill w-30"></div>
            </div>
          </div>
        </article>
        {% endfor %}
      </div>

      <!-- Grid real -->
      <div id="real-grid" class="grid">
        {% for b in barbearias %}
        <article class="card">
          <div class="card-media">
            {% if b.foto %}
              <img src="{{ b.foto.url }}" alt="Foto da barbearia {{ b.nome }}">
            {% else %}
              <img src="https://images.unsplash.com/photo-1516979187457-637abb4f9353?q=80&w=1400&auto=format&fit=crop" alt="Barbearia padr√£o">
            {% endif %}
            <div class="badge-top">üìç Pr√≥xima de voc√™</div>
          </div>

          <div class="card-body">
            <div class="card-title">
              <h3>{{ b.nome }}</h3>
              <div class="rating">‚≠ê {{ b.nota }}</div>
            </div>

            <p class="address">{{ b.endereco }}</p>

            <div class="card-actions">
              <a class="btn-details" href="#">Ver detalhes</a>
              <a class="btn-details" href="{% url 'agendar_horario' %}">Agendar</a>
            </div>
          </div>
        </article>
        {% empty %}
          <div class="empty">Nenhuma barbearia cadastrada ainda.</div>
        {% endfor %}
      </div>

      <!-- Pagina√ß√£o -->
      {% if is_paginated %}
      <nav class="pagination">
        {% if page_obj.has_previous %}
          <a class="page-btn" href="?q={{ q }}&ordem={{ ordem }}&page={{ page_obj.previous_page_number }}">‚Üê Anterior</a>
        {% else %}
          <span class="page-btn disabled">‚Üê Anterior</span>
        {% endif %}

        <div class="page-numbers">
          {% if page_obj.number > 2 %}
            <a class="page-num" href="?q={{ q }}&ordem={{ ordem }}&page=1">1</a>
            {% if page_obj.number > 3 %}
              <span class="page-ellipsis">‚Ä¶</span>
            {% endif %}
          {% endif %}

          {% for num in page_obj.paginator.page_range %}
            {% if num >= page_obj.number|add:"-1" and num <= page_obj.number|add:"1" %}
              {% if num == page_obj.number %}
                <span class="page-num active">{{ num }}</span>
              {% else %}
                <a class="page-num" href="?q={{ q }}&ordem={{ ordem }}&page={{ num }}">{{ num }}</a>
              {% endif %}
            {% endif %}
          {% endfor %}

          {% if page_obj.number < page_obj.paginator.num_pages|add:"-1" %}
            {% if page_obj.number < page_obj.paginator.num_pages|add:"-2" %}
              <span class="page-ellipsis">‚Ä¶</span>
            {% endif %}
            <a class="page-num" href="?q={{ q }}&ordem={{ ordem }}&page={{ page_obj.paginator.num_pages }}">
              {{ page_obj.paginator.num_pages }}
            </a>
          {% endif %}
        </div>

        {% if page_obj.has_next %}
          <a class="page-btn" href="?q={{ q }}&ordem={{ ordem }}&page={{ page_obj.next_page_number }}">Pr√≥xima ‚Üí</a>
        {% else %}
          <span class="page-btn disabled">Pr√≥xima ‚Üí</span>
        {% endif %}
      </nav>
      {% endif %}
    </section>
  </main>

  <!-- FOOTER -->
  <footer>
    <div class="footer-inner">
      <div style="display:flex;align-items:center;gap:8px;font-weight:700;color:var(--text);">
        <span class="logo-mark" style="width:28px;height:28px;font-size:.9rem;">B</span>
        BarberFinder
      </div>
      <div>¬© {{ year }} BarberFinder ‚Äî Todos os direitos reservados.</div>
    </div>
  </footer>

  <!-- Skeleton: ativa durante submit/pagina√ß√£o -->
  <script>
    (function(){
      const skeleton = document.getElementById("skeleton-grid");
      const real = document.getElementById("real-grid");
      const filtersForm = document.querySelector(".filters");
      const pagination = document.querySelector(".pagination");

      function showSkeleton(){
        if(skeleton && real){
          skeleton.classList.remove("hidden");
          real.classList.add("hidden");
          window.scrollTo({ top: real.offsetTop - 120, behavior: "smooth" });
        }
      }

      if(filtersForm){
        filtersForm.addEventListener("submit", function(){ showSkeleton(); });
      }

      if(pagination){
        pagination.addEventListener("click", function(e){
          const a = e.target.closest("a");
          if(a) showSkeleton();
        });
      }
    })();
  </script>

</body>
</html>
